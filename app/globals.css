@import "../styles/theme.css";
@import "../styles/premium.css";
@tailwind base;
@tailwind components;
@tailwind utilities;

/* -------------------------------------------------------------------------- */
/* Global + Token Variables                                                    */
/* -------------------------------------------------------------------------- */

:root {
  color-scheme: light;

  /* Default token values (app overrides these via .app-ui wrapper) */
  --bg: 210 40% 98%;
  --surface: 0 0% 100%;
  --surface-muted: 210 40% 96%;

  --text: 222 47% 11%;
  --text-muted: 215 16% 47%;

  --primary: 204 94% 53%;
  --success: 142 71% 45%;
  --warning: 45 93% 55%;
  --danger-soft: 14 90% 60%;

  --outline: 214 32% 91%;
  --focus: 204 94% 53%;
}

html,
body {
  height: 100%;
  /* Removed overscroll-behavior-y: none to restore natural bounce */
}

/* -------------------------------------------------------------------------- */
/* Base Body Styling                                                           */
/* -------------------------------------------------------------------------- */

body {
  @apply text-slate-900 antialiased h-full overflow-x-hidden;
  background: rgb(var(--skz-bg-0));
  /* Removed scroll-behavior: smooth to prevent fighting with native gestures */
}

::selection {
  background: rgba(99, 102, 241, 0.3); /* Indigo selection */
}

.container-pad {
  @apply max-w-7xl mx-auto px-4 sm:px-6 lg:px-8;
}

/* -------------------------------------------------------------------------- */
/* Scrollbar Styling                                                           */
/* -------------------------------------------------------------------------- */

::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}
::-webkit-scrollbar-track {
  background: transparent;
}
::-webkit-scrollbar-thumb {
  background: rgba(15, 23, 42, 0.1);
  border-radius: 99px;
}
::-webkit-scrollbar-thumb:hover {
  background: rgba(15, 23, 42, 0.2);
}

/* -------------------------------------------------------------------------- */
/* Marketing Mode - VIBRANT UPGRADE                                            */
/* -------------------------------------------------------------------------- */

.marketing-ui {
  min-height: 100vh;
  /* Richer, more saturated mesh gradient */
  background: 
    radial-gradient(1000px 1000px at 10% 10%, rgba(99, 102, 241, 0.18), transparent 60%), /* Indigo */
    radial-gradient(800px 800px at 90% 20%, rgba(236, 72, 153, 0.15), transparent 50%), /* Pink */
    radial-gradient(900px 900px at 50% 90%, rgba(20, 184, 166, 0.12), transparent 50%), /* Teal */
    linear-gradient(180deg, #f8fafc 0%, #ffffff 100%);
  background-attachment: fixed;
}

.marketing-ui ::selection {
  background: rgba(168, 85, 247, 0.2); /* Purple selection */
}

/* -------------------------------------------------------------------------- */
/* App Mode                                                                    */
/* -------------------------------------------------------------------------- */

.app-ui {
  min-height: 100vh;
  --bg: 204 100% 97%;
  --surface: 0 0% 100%;
  --surface-muted: 204 45% 94%;
  --text: 222 47% 11%;
  --text-muted: 215 16% 47%;
  --primary: 204 94% 53%;
  --success: 142 71% 45%;
  --warning: 45 93% 55%;
  --danger-soft: 14 90% 60%;
  --outline: 214 32% 91%;
  --focus: 204 94% 53%;
  color: hsl(var(--text));
  background: hsl(var(--bg));
}

.app-ui ::selection {
  background: hsl(var(--primary) / 0.2);
}

/* -------------------------------------------------------------------------- */
/* App Component Utilities                                                     */
/* -------------------------------------------------------------------------- */

@layer components {
  .sk-card {
    @apply bg-surface text-text rounded-card shadow-e1 border border-outline;
  }
  .sk-card-tappable {
    @apply sk-card transition-transform duration-150 active:scale-[0.98] hover:shadow-e2;
  }
  .sk-btn {
    @apply inline-flex items-center justify-center rounded-pill font-semibold
      px-5 py-3 text-base transition-transform duration-150 shadow-e2
      active:scale-[0.98] focus:outline-none focus:ring-4 focus:ring-focus/20;
  }
  .sk-btn-primary {
    @apply sk-btn bg-primary text-white hover:bg-primary/90;
  }
  .sk-btn-muted {
    @apply sk-btn bg-surface-muted text-text hover:bg-surface-muted/80 shadow-e1;
  }
  .sk-chip {
    @apply inline-flex items-center gap-1 rounded-pill px-3 py-1 text-xs font-semibold
      bg-surface-muted text-text border border-outline;
  }
}

@layer utilities {
  .glass {
    background: rgba(255, 255, 255, 0.72);
    backdrop-filter: blur(14px);
    -webkit-backdrop-filter: blur(14px);
  }
  .shadow-elevated {
    box-shadow: 0 18px 55px rgba(2, 6, 23, 0.12);
  }
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

/* Animations */
@keyframes pop {
  0% { transform: scale(1); }
  35% { transform: scale(1.06); }
  100% { transform: scale(1); }
}
.animate-pop { animation: pop 260ms ease-out; }

.sk-confetti{
  position:absolute;
  width:10px;
  height:14px;
  border-radius: 4px;
  background: rgba(79,70,229,0.95);
  transform: translate(0,0) rotate(0deg) scale(var(--s,1));
  animation: confetti-fly var(--d,0.8s) ease-out forwards;
  box-shadow: 0 10px 30px rgba(2,6,23,0.12);
}
.sk-confetti:nth-child(4n+1){ background: rgba(45,212,191,0.95); }
.sk-confetti:nth-child(4n+2){ background: rgba(251,191,36,0.95); }
.sk-confetti:nth-child(4n+3){ background: rgba(59,130,246,0.95); }

@keyframes confetti-fly{
  to{
    transform: translate(var(--dx), var(--dy)) rotate(var(--rz)) scale(var(--s,1));
    opacity: 0;
  }
}

/* Marquee */
@keyframes marquee-scroll {
  from { transform: translateX(0); }
  to { transform: translateX(-50%); }
}
@layer utilities {
  .marquee { position: relative; overflow: hidden; padding: 18px 18px 22px; }
  .marquee-track { display: flex; gap: 16px; width: max-content; animation: marquee-scroll 26s linear infinite; will-change: transform; }
  .marquee:hover .marquee-track { animation-play-state: paused; }
  .marquee-item { width: 360px; flex: 0 0 auto; }
  @media (max-width: 640px) { .marquee-item { width: 280px; } }
}

/* Premium Theme Vars */
:root{
  --skz-bg-0: 255 255 255;
  --skz-bg-1: 248 250 252;
  --skz-ink: 15 23 42;
  --skz-muted: 100 116 139;
  --skz-card: 255 255 255;
  --skz-glass: 255 255 255;
  --skz-glass-border: 226 232 240;
  --skz-shadow: 0 20px 40px rgba(2,6,23,.08), 0 6px 18px rgba(2,6,23,.06);
}
.skz-glass{
  background: rgba(var(--skz-glass), .72);
  border: 1px solid rgba(var(--skz-glass-border), .7);
  box-shadow: var(--skz-shadow);
  backdrop-filter: blur(14px);
  -webkit-backdrop-filter: blur(14px);
  border-radius: 24px;
}
.skz-card{
  background: rgba(var(--skz-card), .9);
  border: 1px solid rgba(var(--skz-glass-border), .7);
  border-radius: 24px;
  box-shadow: 0 18px 32px rgba(2,6,23,.06);
}
.skz-soft-ring{ box-shadow: 0 0 0 6px rgba(99,102,241,.08); }
.skz-divider{ height: 1px; background: linear-gradient(90deg, transparent, rgba(148,163,184,.6), transparent); }

/* Motion */
:root { --skz-ease: cubic-bezier(0.16, 1, 0.3, 1); }
.skz-press { transition: transform 160ms var(--skz-ease), box-shadow 220ms var(--skz-ease); will-change: transform; }
.skz-press:active { transform: scale(.98); }
@media (prefers-reduced-motion: reduce){
  * { scroll-behavior: auto !important; }
  .skz-press { transition: none !important; }
}
.line-clamp-2{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;}

.skz-glow{ position: relative; overflow: hidden; }
.skz-glow::before{
  content:""; position:absolute; inset:-2px;
  background: radial-gradient(500px 220px at var(--mx,50%) var(--my,20%), rgba(99,102,241,.26), rgba(236,72,153,.14), rgba(16,185,129,.10), transparent 60%);
  opacity: 0; transition: opacity 260ms var(--skz-ease); pointer-events:none; filter: blur(10px);
}
.skz-glow:hover::before{ opacity: 1; }

.skz-border-animate{ position: relative; }
.skz-border-animate::after{
  content:""; position:absolute; inset:-1px; border-radius: inherit; padding:1px;
  background: linear-gradient(90deg, rgba(99,102,241,.65), rgba(236,72,153,.55), rgba(16,185,129,.55), rgba(99,102,241,.65));
  background-size: 220% 100%; animation: skzGradientMove 7s linear infinite;
  -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
  -webkit-mask-composite: xor; mask-composite: exclude; opacity:.55; pointer-events:none;
}
@keyframes skzGradientMove{ 0%{ background-position: 0% 50%; } 100%{ background-position: 220% 50%; } }

.skz-shine{ position:relative; overflow:hidden; }
.skz-shine::after{
  content:""; position:absolute; top:-40%; left:-60%; width:50%; height:180%; transform: rotate(22deg);
  background: linear-gradient(90deg, transparent, rgba(255,255,255,.42), transparent);
  opacity:.0; transition: opacity 260ms var(--skz-ease); pointer-events:none;
}
.skz-shine:hover::after{ opacity:.75; animation: skzShine 900ms var(--skz-ease) 1; }
@keyframes skzShine{ 0%{ transform: translateX(0) rotate(22deg); } 100%{ transform: translateX(260%) rotate(22deg); } }

.skz-ambient{ position: relative; }
.skz-ambient::before{
  content:""; position: fixed; inset: 0; pointer-events:none;
  background: radial-gradient(900px 600px at 10% 10%, rgba(99,102,241,.14), transparent 60%), radial-gradient(900px 600px at 90% 0%, rgba(236,72,153,.12), transparent 55%), radial-gradient(900px 600px at 85% 90%, rgba(16,185,129,.10), transparent 55%);
  opacity: .75; filter: blur(0px); animation: skzAmbientDrift 38s var(--skz-ease) infinite alternate;
}
@keyframes skzAmbientDrift{ 0%{ transform: translate3d(0,0,0) scale(1); opacity: .70; } 100%{ transform: translate3d(0,-12px,0) scale(1.03); opacity: .85; } }

.skz-float{ animation: skzFloat 6.5s var(--skz-ease) infinite alternate; will-change: transform; }
@keyframes skzFloat{ 0%{ transform: translateY(0px); } 100%{ transform: translateY(-3px); } }

.skz-breathe{ animation: skzBreathe 7.5s var(--skz-ease) infinite; }
@keyframes skzBreathe{ 0%,100%{ filter: brightness(1); } 50%{ filter: brightness(1.03); } }

@media (prefers-reduced-motion: reduce){ .skz-ambient::before, .skz-float, .skz-breathe { animation: none !important; } }

[data-theme="parent"]{ --radius-lg: 1rem; --shadow-e1: 0 10px 30px rgba(15, 23, 42, 0.08); --shadow-e2: 0 20px 60px rgba(15, 23, 42, 0.12); }
[data-theme="kid"]{ --radius-lg: 1.25rem; --shadow-e1: 0 14px 36px rgba(15, 23, 42, 0.10); --shadow-e2: 0 26px 80px rgba(15, 23, 42, 0.14); }

.skz-noise{
  position: absolute; inset: -20%; pointer-events: none; opacity: .12; mix-blend-mode: soft-light;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='180' height='180'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='180' height='180' filter='url(%23n)' opacity='.55'/%3E%3C/svg%3E");
  background-size: 180px 180px; transform: rotate(2deg);
}
@keyframes skzGradientShift{ 0%{ background-position: 0% 50%; } 50%{ background-position: 100% 50%; } 100%{ background-position: 0% 50%; } }

.skz-backdrop{ position: fixed; inset: 0; z-index: -1; background: linear-gradient(120deg, rgba(var(--skz-bg-0), 1), rgba(var(--skz-bg-1), 1)); }
.skz-backdrop[data-variant="home"]{ background: radial-gradient(1200px 900px at 30% 12%, rgba(var(--skz-primary), .18), transparent 55%), radial-gradient(900px 700px at 85% 30%, rgba(var(--skz-accent), .18), transparent 55%), linear-gradient(120deg, rgba(var(--skz-bg-0), 1), rgba(var(--skz-bg-1), 1)); background-size: 240% 240%; animation: skzGradientShift 14s var(--skz-ease) infinite; }
.skz-backdrop[data-variant="worlds"]{ background: radial-gradient(900px 800px at 30% 18%, rgba(var(--skz-primary), .15), transparent 55%), radial-gradient(900px 800px at 70% 65%, rgba(56, 189, 248, .14), transparent 58%), radial-gradient(900px 800px at 88% 20%, rgba(var(--skz-accent), .12), transparent 55%), linear-gradient(120deg, rgba(var(--skz-bg-0), 1), rgba(var(--skz-bg-1), 1)); }
.skz-backdrop[data-variant="lesson"]{ background: radial-gradient(900px 700px at 25% 20%, rgba(var(--skz-accent), .16), transparent 55%), radial-gradient(900px 700px at 80% 25%, rgba(var(--skz-primary), .16), transparent 55%), linear-gradient(120deg, rgba(var(--skz-bg-0), 1), rgba(var(--skz-bg-1), 1)); background-size: 220% 220%; animation: skzGradientShift 10s var(--skz-ease) infinite; }
.skz-backdrop[data-variant="rewards"]{ background: radial-gradient(900px 700px at 30% 20%, rgba(250, 204, 21, .14), transparent 55%), radial-gradient(900px 700px at 80% 30%, rgba(var(--skz-accent), .14), transparent 55%), linear-gradient(120deg, rgba(var(--skz-bg-0), 1), rgba(var(--skz-bg-1), 1)); }
.skz-backdrop[data-variant="parent"]{ background: radial-gradient(1000px 800px at 20% 10%, rgba(15,23,42,.35), transparent 60%), radial-gradient(900px 700px at 80% 25%, rgba(var(--skz-primary), .10), transparent 55%), linear-gradient(120deg, rgba(248,250,252,1), rgba(241,245,249,1)); background-size: 220% 220%; animation: skzGradientShift 18s var(--skz-ease) infinite; }

.skz-ambient-canvas{ mix-blend-mode: soft-light; opacity: .9; }
html[data-skz-variant="parent"] .skz-ambient-canvas{ opacity: .55; }
.skz-pill{ border-radius: var(--skz-radius-btn); box-shadow: var(--skz-shadow-1); }
.skz-pressable{ transform: translateZ(0); transition: transform .12s var(--skz-ease), filter .12s var(--skz-ease); }
.skz-pressable:active{ transform: scale(.95); filter: brightness(.98); }
.skz-dock{ background: rgba(255,255,255,.58); border: 1px solid rgba(255,255,255,.52); backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px); box-shadow: 0 22px 70px rgba(2,6,23,.18); border-radius: 28px; }
.skz-dock-item{ width: 56px; height: 56px; border-radius: 18px; display: grid; place-items: center; box-shadow: 0 8px 18px rgba(2,6,23,.10); }